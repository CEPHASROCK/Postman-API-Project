{
	"info": {
		"_postman_id": "084eabf7-82f4-4e88-a909-d627c25830af",
		"name": "API Project",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "28605180"
	},
	"item": [
		{
			"name": "Users",
			"item": [
				{
					"name": "Register new user",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ============================================",
									"// COMPREHENSIVE USER REGISTRATION TEST SUITE",
									"// ============================================",
									"",
									"const responseJson = pm.response.json();",
									"const responseTime = pm.response.responseTime;",
									"const statusCode = pm.response.code;",
									"",
									"// ============================================",
									"// 1. STATUS CODE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Status code is valid (200, 201 for success OR 422 for validation error)\", function () {",
									"    pm.expect(statusCode).to.be.oneOf([200, 201, 422]);",
									"});",
									"",
									"pm.test(\"Successful registration returns 201 Created\", function () {",
									"    if (statusCode === 201 || statusCode === 200) {",
									"        pm.expect(statusCode).to.be.oneOf([200, 201]);",
									"    } else {",
									"        // Skip this test for error responses",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Validation error returns 422 Unprocessable Entity\", function () {",
									"    if (statusCode === 422) {",
									"        pm.expect(statusCode).to.eql(422);",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 2. RESPONSE BODY STRUCTURE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Response body is valid JSON\", function () {",
									"    pm.response.to.be.json;",
									"});",
									"",
									"// Success response structure validation",
									"pm.test(\"Success response contains expected user fields\", function () {",
									"    if (statusCode === 200 || statusCode === 201) {",
									"        pm.expect(responseJson).to.be.an('object');",
									"        // Common fields expected in a successful registration response",
									"        const expectedFields = ['id', 'first_name', 'last_name', 'email'];",
									"        expectedFields.forEach(function(field) {",
									"            pm.expect(responseJson).to.have.property(field);",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// Error response structure validation",
									"pm.test(\"Error response contains validation error object\", function () {",
									"    if (statusCode === 422) {",
									"        pm.expect(responseJson).to.be.an('object');",
									"        pm.expect(Object.keys(responseJson).length).to.be.greaterThan(0);",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 3. REQUIRED FIELD VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Required fields validation - error messages are arrays\", function () {",
									"    if (statusCode === 422) {",
									"        const requiredFields = ['first_name', 'last_name', 'email', 'password'];",
									"        Object.keys(responseJson).forEach(function(field) {",
									"            if (requiredFields.includes(field)) {",
									"                pm.expect(responseJson[field]).to.be.an('array');",
									"                pm.expect(responseJson[field].length).to.be.greaterThan(0);",
									"            }",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Each validation error message is a non-empty string\", function () {",
									"    if (statusCode === 422) {",
									"        Object.keys(responseJson).forEach(function(field) {",
									"            responseJson[field].forEach(function(message) {",
									"                pm.expect(message).to.be.a('string');",
									"                pm.expect(message.trim().length).to.be.greaterThan(0);",
									"            });",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 4. EMAIL FORMAT VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Email validation error message is descriptive\", function () {",
									"    if (statusCode === 422 && responseJson.email) {",
									"        pm.expect(responseJson.email).to.be.an('array');",
									"        const emailErrors = responseJson.email.join(' ').toLowerCase();",
									"        // Check that email-related error exists",
									"        pm.expect(emailErrors).to.satisfy(function(msg) {",
									"            return msg.includes('email') || msg.includes('required') || msg.includes('valid') || msg.includes('format');",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// Helper function to validate email format (for use in pre-request or custom validation)",
									"const isValidEmail = function(email) {",
									"    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;",
									"    return emailRegex.test(email);",
									"};",
									"",
									"pm.test(\"Email format validation helper works correctly\", function () {",
									"    pm.expect(isValidEmail(\"test@example.com\")).to.be.true;",
									"    pm.expect(isValidEmail(\"invalid-email\")).to.be.false;",
									"    pm.expect(isValidEmail(\"\")).to.be.false;",
									"    pm.expect(isValidEmail(\"test@\")).to.be.false;",
									"});",
									"",
									"// ============================================",
									"// 5. PASSWORD STRENGTH VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Password validation error message exists when password is invalid\", function () {",
									"    if (statusCode === 422 && responseJson.password) {",
									"        pm.expect(responseJson.password).to.be.an('array');",
									"        pm.expect(responseJson.password.length).to.be.greaterThan(0);",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// Helper function to validate password strength",
									"const isStrongPassword = function(password) {",
									"    // At least 8 characters, contains uppercase, lowercase, number, and special character",
									"    const minLength = password.length >= 8;",
									"    const hasUppercase = /[A-Z]/.test(password);",
									"    const hasLowercase = /[a-z]/.test(password);",
									"    const hasNumber = /[0-9]/.test(password);",
									"    const hasSpecial = /[!@#$%^&*(),.?\":{}|<>]/.test(password);",
									"    return minLength && hasUppercase && hasLowercase && hasNumber && hasSpecial;",
									"};",
									"",
									"pm.test(\"Password strength validation helper works correctly\", function () {",
									"    pm.expect(isStrongPassword(\"SuperSecure@123\")).to.be.true;",
									"    pm.expect(isStrongPassword(\"weak\")).to.be.false;",
									"    pm.expect(isStrongPassword(\"NoSpecialChar1\")).to.be.false;",
									"});",
									"",
									"// ============================================",
									"// 6. RESPONSE TIME / PERFORMANCE CHECK",
									"// ============================================",
									"",
									"pm.test(\"Response time is acceptable (under 2000ms)\", function () {",
									"    pm.expect(responseTime).to.be.below(2000);",
									"});",
									"",
									"pm.test(\"Response time is optimal (under 500ms)\", function () {",
									"    if (responseTime < 500) {",
									"        pm.expect(responseTime).to.be.below(500);",
									"    } else {",
									"        console.log(\"Warning: Response time is \" + responseTime + \"ms - consider optimization\");",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 7. CONTENT-TYPE HEADER VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Content-Type header is present\", function () {",
									"    pm.response.to.have.header(\"Content-Type\");",
									"});",
									"",
									"pm.test(\"Content-Type is application/json\", function () {",
									"    const contentType = pm.response.headers.get(\"Content-Type\");",
									"    pm.expect(contentType).to.include(\"application/json\");",
									"});",
									"",
									"// ============================================",
									"// 8. ERROR MESSAGE STRUCTURE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Error messages follow consistent structure\", function () {",
									"    if (statusCode === 422) {",
									"        // Each field should have an array of error messages",
									"        Object.keys(responseJson).forEach(function(field) {",
									"            pm.expect(responseJson[field]).to.be.an('array', ",
									"                \"Field '\" + field + \"' should have an array of error messages\");",
									"            ",
									"            responseJson[field].forEach(function(message, index) {",
									"                pm.expect(message).to.be.a('string', ",
									"                    \"Error message at index \" + index + \" for field '\" + field + \"' should be a string\");",
									"            });",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Error messages are human-readable\", function () {",
									"    if (statusCode === 422) {",
									"        Object.keys(responseJson).forEach(function(field) {",
									"            responseJson[field].forEach(function(message) {",
									"                // Check that message is not just a code or key",
									"                pm.expect(message.length).to.be.greaterThan(5);",
									"                // Check that message contains spaces (indicating a sentence)",
									"                pm.expect(message).to.include(' ');",
									"            });",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 9. DATA PERSISTENCE VALIDATION (Success Case)",
									"// ============================================",
									"",
									"pm.test(\"Successful registration returns user ID\", function () {",
									"    if (statusCode === 200 || statusCode === 201) {",
									"        pm.expect(responseJson).to.have.property('id');",
									"        pm.expect(responseJson.id).to.not.be.null;",
									"        pm.expect(responseJson.id).to.not.be.undefined;",
									"        ",
									"        // Store user ID for potential cleanup or subsequent tests",
									"        if (responseJson.id) {",
									"            pm.collectionVariables.set(\"created_user_id\", responseJson.id);",
									"        }",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Successful registration echoes back user data correctly\", function () {",
									"    if (statusCode === 200 || statusCode === 201) {",
									"        const requestBody = JSON.parse(pm.request.body.raw);",
									"        ",
									"        // Verify returned data matches submitted data",
									"        if (responseJson.first_name) {",
									"            pm.expect(responseJson.first_name).to.eql(requestBody.first_name);",
									"        }",
									"        if (responseJson.last_name) {",
									"            pm.expect(responseJson.last_name).to.eql(requestBody.last_name);",
									"        }",
									"        if (responseJson.email) {",
									"            pm.expect(responseJson.email).to.eql(requestBody.email);",
									"        }",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Password is not returned in response (security check)\", function () {",
									"    if (statusCode === 200 || statusCode === 201) {",
									"        pm.expect(responseJson).to.not.have.property('password');",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 10. EDGE CASES VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Response handles empty/missing fields appropriately\", function () {",
									"    if (statusCode === 422) {",
									"        // Verify that the API properly identifies missing required fields",
									"        const possibleRequiredFields = ['first_name', 'last_name', 'email', 'password'];",
									"        const errorFields = Object.keys(responseJson);",
									"        ",
									"        errorFields.forEach(function(field) {",
									"            pm.expect(possibleRequiredFields).to.include(field, ",
									"                \"Unexpected validation error field: \" + field);",
									"        });",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"No server error occurred (5xx)\", function () {",
									"    pm.expect(statusCode).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response is not empty\", function () {",
									"    pm.expect(pm.response.text()).to.not.be.empty;",
									"    pm.expect(Object.keys(responseJson).length).to.be.greaterThan(0);",
									"});",
									"",
									"// ============================================",
									"// SUMMARY LOG",
									"// ============================================",
									"",
									"console.log(\"=== Registration Test Summary ===\");",
									"console.log(\"Status Code: \" + statusCode);",
									"console.log(\"Response Time: \" + responseTime + \"ms\");",
									"console.log(\"Response Type: \" + (statusCode === 422 ? \"Validation Error\" : \"Success\"));",
									"if (statusCode === 422) {",
									"    console.log(\"Validation Errors Found: \" + Object.keys(responseJson).join(\", \"));",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"first_name\": \"Tobi\",\r\n  \"last_name\": \"Dane\",\r\n  \"address\": {\r\n    \"street\": \"Street 3\",\r\n    \"city\": \"ikeja\",\r\n    \"state\": \"lagos\",\r\n    \"country\": \"Nigeria\",\r\n    \"postal_code\": \"1234AA\"\r\n  },\r\n  \"phone\": \"0987654321\",\r\n  \"dob\": \"1970-01-01\",\r\n  \"password\": \"SuperSecure@123\",\r\n  \"email\": \"tobi@gmail.example\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://api.practicesoftwaretesting.com/users/register",
							"protocol": "https",
							"host": [
								"api",
								"practicesoftwaretesting",
								"com"
							],
							"path": [
								"users",
								"register"
							]
						}
					},
					"response": []
				},
				{
					"name": "Log in",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ============================================",
									"// LOGIN API - COMPREHENSIVE TEST SUITE",
									"// ============================================",
									"",
									"const responseJson = pm.response.json();",
									"const responseCode = pm.response.code;",
									"",
									"// ============================================",
									"// 1. STATUS CODE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Status code is valid (200, 401, or 422)\", function () {",
									"    pm.expect(responseCode).to.be.oneOf([200, 401, 422]);",
									"});",
									"",
									"pm.test(\"Successful login returns 200 status code\", function () {",
									"    if (responseCode === 200) {",
									"        pm.response.to.have.status(200);",
									"    }",
									"});",
									"",
									"pm.test(\"Invalid credentials return 401 status code\", function () {",
									"    if (responseCode === 401) {",
									"        pm.response.to.have.status(401);",
									"    }",
									"});",
									"",
									"pm.test(\"Validation errors return 422 status code\", function () {",
									"    if (responseCode === 422) {",
									"        pm.response.to.have.status(422);",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 2. RESPONSE BODY STRUCTURE VALIDATION",
									"// ============================================",
									"",
									"if (responseCode === 200) {",
									"    pm.test(\"Response contains 'access_token' field\", function () {",
									"        pm.expect(responseJson).to.have.property(\"access_token\");",
									"    });",
									"",
									"    pm.test(\"Response contains 'token_type' field\", function () {",
									"        pm.expect(responseJson).to.have.property(\"token_type\");",
									"    });",
									"",
									"    pm.test(\"Response contains 'expires_in' field\", function () {",
									"        pm.expect(responseJson).to.have.property(\"expires_in\");",
									"    });",
									"",
									"    pm.test(\"access_token is a non-empty string\", function () {",
									"        pm.expect(responseJson.access_token).to.be.a(\"string\").and.not.empty;",
									"    });",
									"",
									"    pm.test(\"token_type is a string\", function () {",
									"        pm.expect(responseJson.token_type).to.be.a(\"string\");",
									"    });",
									"",
									"    pm.test(\"expires_in is a number\", function () {",
									"        pm.expect(responseJson.expires_in).to.be.a(\"number\");",
									"    });",
									"}",
									"",
									"// ============================================",
									"// 3. JWT TOKEN FORMAT VALIDATION",
									"// ============================================",
									"",
									"if (responseCode === 200) {",
									"    pm.test(\"Access token has valid JWT structure (3 parts separated by dots)\", function () {",
									"        const token = responseJson.access_token;",
									"        const parts = token.split(\".\");",
									"        pm.expect(parts).to.have.lengthOf(3, \"JWT should have 3 parts: header, payload, signature\");",
									"    });",
									"",
									"    pm.test(\"JWT header is valid base64 encoded JSON\", function () {",
									"        const token = responseJson.access_token;",
									"        const headerPart = token.split(\".\")[0];",
									"        try {",
									"            const decoded = atob(headerPart);",
									"            const header = JSON.parse(decoded);",
									"            pm.expect(header).to.have.property(\"typ\");",
									"            pm.expect(header).to.have.property(\"alg\");",
									"        } catch (e) {",
									"            pm.expect.fail(\"JWT header is not valid base64 encoded JSON\");",
									"        }",
									"    });",
									"",
									"    pm.test(\"JWT payload is valid base64 encoded JSON\", function () {",
									"        const token = responseJson.access_token;",
									"        const payloadPart = token.split(\".\")[1];",
									"        try {",
									"            const decoded = atob(payloadPart);",
									"            const payload = JSON.parse(decoded);",
									"            pm.expect(payload).to.be.an(\"object\");",
									"        } catch (e) {",
									"            pm.expect.fail(\"JWT payload is not valid base64 encoded JSON\");",
									"        }",
									"    });",
									"}",
									"",
									"// ============================================",
									"// 4. TOKEN TYPE VALIDATION",
									"// ============================================",
									"",
									"if (responseCode === 200) {",
									"    pm.test(\"Token type is 'bearer'\", function () {",
									"        pm.expect(responseJson.token_type.toLowerCase()).to.eql(\"bearer\");",
									"    });",
									"}",
									"",
									"// ============================================",
									"// 5. TOKEN EXPIRATION VALIDATION",
									"// ============================================",
									"",
									"if (responseCode === 200) {",
									"    pm.test(\"expires_in is a positive number\", function () {",
									"        pm.expect(responseJson.expires_in).to.be.above(0);",
									"    });",
									"",
									"    pm.test(\"expires_in is a reasonable value (between 1 second and 1 year)\", function () {",
									"        const oneYear = 365 * 24 * 60 * 60; // seconds in a year",
									"        pm.expect(responseJson.expires_in).to.be.at.least(1);",
									"        pm.expect(responseJson.expires_in).to.be.at.most(oneYear);",
									"    });",
									"}",
									"",
									"// ============================================",
									"// 6. REQUEST BODY VALIDATION (for error responses)",
									"// ============================================",
									"",
									"if (responseCode === 422) {",
									"    pm.test(\"Validation error response contains error details\", function () {",
									"        pm.expect(responseJson).to.satisfy(function(body) {",
									"            return body.hasOwnProperty(\"error\") || ",
									"                   body.hasOwnProperty(\"errors\") || ",
									"                   body.hasOwnProperty(\"message\");",
									"        }, \"Response should contain error, errors, or message field\");",
									"    });",
									"",
									"    pm.test(\"Validation errors indicate missing/invalid fields\", function () {",
									"        const responseText = JSON.stringify(responseJson).toLowerCase();",
									"        const hasEmailError = responseText.includes(\"email\");",
									"        const hasPasswordError = responseText.includes(\"password\");",
									"        const hasValidationError = responseText.includes(\"required\") || ",
									"                                   responseText.includes(\"invalid\") || ",
									"                                   responseText.includes(\"validation\");",
									"        pm.expect(hasEmailError || hasPasswordError || hasValidationError).to.be.true;",
									"    });",
									"}",
									"",
									"// ============================================",
									"// 7. RESPONSE TIME / PERFORMANCE CHECK",
									"// ============================================",
									"",
									"pm.test(\"Response time is acceptable (under 2000ms)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});",
									"",
									"pm.test(\"Response time is optimal (under 500ms)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(500);",
									"});",
									"",
									"// ============================================",
									"// 8. CONTENT-TYPE HEADER VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Content-Type header is present\", function () {",
									"    pm.response.to.have.header(\"Content-Type\");",
									"});",
									"",
									"pm.test(\"Content-Type is application/json\", function () {",
									"    const contentType = pm.response.headers.get(\"Content-Type\");",
									"    pm.expect(contentType).to.include(\"application/json\");",
									"});",
									"",
									"// ============================================",
									"// 9. TOKEN STORAGE FOR SUBSEQUENT REQUESTS",
									"// ============================================",
									"",
									"if (responseCode === 200 && responseJson.access_token) {",
									"    pm.test(\"Access token saved to collection variable\", function () {",
									"        pm.collectionVariables.set(\"access_token\", responseJson.access_token);",
									"        pm.expect(pm.collectionVariables.get(\"access_token\")).to.eql(responseJson.access_token);",
									"    });",
									"",
									"    pm.test(\"Token type saved to collection variable\", function () {",
									"        pm.collectionVariables.set(\"token_type\", responseJson.token_type);",
									"        pm.expect(pm.collectionVariables.get(\"token_type\")).to.eql(responseJson.token_type);",
									"    });",
									"",
									"    pm.test(\"Token expiration saved to collection variable\", function () {",
									"        pm.collectionVariables.set(\"token_expires_in\", responseJson.expires_in);",
									"        pm.expect(pm.collectionVariables.get(\"token_expires_in\")).to.eql(responseJson.expires_in);",
									"    });",
									"",
									"    // Store timestamp for token expiration tracking",
									"    const tokenExpiresAt = Date.now() + (responseJson.expires_in * 1000);",
									"    pm.collectionVariables.set(\"token_expires_at\", tokenExpiresAt);",
									"}",
									"",
									"// ============================================",
									"// 10. SECURITY CHECKS",
									"// ============================================",
									"",
									"pm.test(\"Password is NOT returned in response\", function () {",
									"    const responseText = JSON.stringify(responseJson);",
									"    pm.expect(responseJson).to.not.have.property(\"password\");",
									"    pm.expect(responseText.toLowerCase()).to.not.include(\"supersecure\");",
									"});",
									"",
									"pm.test(\"Sensitive user data is NOT exposed in response\", function () {",
									"    pm.expect(responseJson).to.not.have.property(\"password_hash\");",
									"    pm.expect(responseJson).to.not.have.property(\"secret\");",
									"    pm.expect(responseJson).to.not.have.property(\"private_key\");",
									"});",
									"",
									"pm.test(\"Response does not contain email in plain text (for successful login)\", function () {",
									"    if (responseCode === 200) {",
									"        pm.expect(responseJson).to.not.have.property(\"email\");",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 11. ERROR MESSAGE STRUCTURE FOR FAILED AUTH",
									"// ============================================",
									"",
									"if (responseCode === 401) {",
									"    pm.test(\"401 response contains error message\", function () {",
									"        pm.expect(responseJson).to.satisfy(function(body) {",
									"            return body.hasOwnProperty(\"error\") || ",
									"                   body.hasOwnProperty(\"message\") ||",
									"                   body.hasOwnProperty(\"detail\");",
									"        }, \"Unauthorized response should contain error information\");",
									"    });",
									"",
									"    pm.test(\"Error message is descriptive but not too revealing\", function () {",
									"        const responseText = JSON.stringify(responseJson).toLowerCase();",
									"        // Should not reveal which field (email or password) was wrong",
									"        const isTooRevealing = responseText.includes(\"email not found\") || ",
									"                               responseText.includes(\"wrong password\") ||",
									"                               responseText.includes(\"user does not exist\");",
									"        pm.expect(isTooRevealing).to.be.false;",
									"    });",
									"}",
									"",
									"// ============================================",
									"// 12. EDGE CASES HANDLING",
									"// ============================================",
									"",
									"// Check response structure is consistent regardless of status",
									"pm.test(\"Response is valid JSON\", function () {",
									"    pm.response.to.be.json;",
									"});",
									"",
									"pm.test(\"Response body is not empty\", function () {",
									"    pm.expect(pm.response.text()).to.not.be.empty;",
									"});",
									"",
									"// For empty credentials or malformed requests",
									"if (responseCode === 422 || responseCode === 400) {",
									"    pm.test(\"Validation error provides actionable feedback\", function () {",
									"        const responseText = JSON.stringify(responseJson).toLowerCase();",
									"        const hasActionableFeedback = responseText.includes(\"required\") ||",
									"                                      responseText.includes(\"invalid\") ||",
									"                                      responseText.includes(\"format\") ||",
									"                                      responseText.includes(\"must\") ||",
									"                                      responseText.includes(\"email\");",
									"        pm.expect(hasActionableFeedback).to.be.true;",
									"    });",
									"}",
									"",
									"// ============================================",
									"// SUMMARY LOG",
									"// ============================================",
									"",
									"console.log(\"=== Login API Test Summary ===\");",
									"console.log(\"Status Code:\", responseCode);",
									"console.log(\"Response Time:\", pm.response.responseTime + \"ms\");",
									"if (responseCode === 200) {",
									"    console.log(\"Token Type:\", responseJson.token_type);",
									"    console.log(\"Token Expires In:\", responseJson.expires_in + \" seconds\");",
									"    console.log(\"Token stored in collection variables: access_token, token_type, token_expires_in, token_expires_at\");",
									"}"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"tobi@gmail.example\",\r\n  \"password\": \"SuperSecure@123\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://api.practicesoftwaretesting.com/users/login",
							"protocol": "https",
							"host": [
								"api",
								"practicesoftwaretesting",
								"com"
							],
							"path": [
								"users",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Forgot password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ============================================",
									"// FORGOT PASSWORD - COMPREHENSIVE TEST SUITE",
									"// ============================================",
									"",
									"const responseJson = pm.response.json();",
									"const responseCode = pm.response.code;",
									"",
									"// ============================================",
									"// 1. STATUS CODE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Status code is one of the expected values (200, 201, 401, 404, 422)\", function () {",
									"    pm.expect(responseCode).to.be.oneOf([200, 201, 401, 404, 422]);",
									"});",
									"",
									"pm.test(\"Status code 200/201 indicates successful password reset request\", function () {",
									"    if (responseCode === 200 || responseCode === 201) {",
									"        pm.expect(responseCode).to.be.oneOf([200, 201]);",
									"        console.log(\"SUCCESS: Password reset request was successful\");",
									"    } else {",
									"        console.log(\"INFO: Response code is \" + responseCode + \" - not a success response\");",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Status code 401 indicates unauthorized access\", function () {",
									"    if (responseCode === 401) {",
									"        pm.expect(responseCode).to.eql(401);",
									"        console.log(\"EXPECTED: Unauthorized access detected\");",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Status code 404 indicates user not found\", function () {",
									"    if (responseCode === 404) {",
									"        pm.expect(responseCode).to.eql(404);",
									"        console.log(\"INFO: User not found in the system\");",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Status code 422 indicates validation error\", function () {",
									"    if (responseCode === 422) {",
									"        pm.expect(responseCode).to.eql(422);",
									"        console.log(\"INFO: Validation error occurred\");",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 2. RESPONSE BODY STRUCTURE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Response body is valid JSON\", function () {",
									"    pm.response.to.be.json;",
									"});",
									"",
									"pm.test(\"Response body contains expected structure\", function () {",
									"    pm.expect(responseJson).to.be.an('object');",
									"    ",
									"    // Check for common response fields",
									"    const hasMessage = responseJson.hasOwnProperty('message');",
									"    const hasError = responseJson.hasOwnProperty('error');",
									"    const hasSuccess = responseJson.hasOwnProperty('success');",
									"    const hasData = responseJson.hasOwnProperty('data');",
									"    ",
									"    pm.expect(hasMessage || hasError || hasSuccess || hasData).to.be.true;",
									"});",
									"",
									"pm.test(\"Success response contains confirmation message\", function () {",
									"    if (responseCode === 200 || responseCode === 201) {",
									"        if (responseJson.message) {",
									"            pm.expect(responseJson.message).to.be.a('string');",
									"            pm.expect(responseJson.message.length).to.be.greaterThan(0);",
									"        }",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Error response contains message field\", function () {",
									"    if (responseCode >= 400) {",
									"        pm.expect(responseJson).to.have.property('message');",
									"        pm.expect(responseJson.message).to.be.a('string');",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 3. EMAIL VALIDATION TESTS",
									"// ============================================",
									"",
									"pm.test(\"Request body contains email field\", function () {",
									"    const requestBody = pm.request.body ? pm.request.body.raw : null;",
									"    if (requestBody) {",
									"        const parsedBody = JSON.parse(requestBody);",
									"        pm.expect(parsedBody).to.have.property('email');",
									"    }",
									"});",
									"",
									"pm.test(\"Email field is not empty in request\", function () {",
									"    const requestBody = pm.request.body ? pm.request.body.raw : null;",
									"    if (requestBody) {",
									"        const parsedBody = JSON.parse(requestBody);",
									"        if (parsedBody.email !== undefined) {",
									"            pm.expect(parsedBody.email).to.not.be.empty;",
									"        }",
									"    }",
									"});",
									"",
									"pm.test(\"Email format validation - proper email structure\", function () {",
									"    const requestBody = pm.request.body ? pm.request.body.raw : null;",
									"    if (requestBody) {",
									"        const parsedBody = JSON.parse(requestBody);",
									"        if (parsedBody.email) {",
									"            const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;",
									"            pm.expect(parsedBody.email).to.match(emailRegex);",
									"        }",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 4. RESPONSE TIME / PERFORMANCE CHECK",
									"// ============================================",
									"",
									"pm.test(\"Response time is acceptable (under 2000ms)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});",
									"",
									"pm.test(\"Response time is optimal (under 500ms)\", function () {",
									"    if (pm.response.responseTime < 500) {",
									"        pm.expect(pm.response.responseTime).to.be.below(500);",
									"        console.log(\"OPTIMAL: Response time is \" + pm.response.responseTime + \"ms\");",
									"    } else {",
									"        console.log(\"WARNING: Response time is \" + pm.response.responseTime + \"ms - consider optimization\");",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 5. CONTENT-TYPE HEADER VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Content-Type header is present\", function () {",
									"    pm.response.to.have.header(\"Content-Type\");",
									"});",
									"",
									"pm.test(\"Content-Type is application/json\", function () {",
									"    const contentType = pm.response.headers.get(\"Content-Type\");",
									"    pm.expect(contentType).to.include(\"application/json\");",
									"});",
									"",
									"// ============================================",
									"// 6. SUCCESS RESPONSE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Success response confirms reset email was sent\", function () {",
									"    if (responseCode === 200 || responseCode === 201) {",
									"        // Check for success indicators",
									"        const successIndicators = ['sent', 'email', 'reset', 'success', 'check', 'inbox'];",
									"        const messageText = (responseJson.message || '').toLowerCase();",
									"        ",
									"        const hasSuccessIndicator = successIndicators.some(indicator => ",
									"            messageText.includes(indicator)",
									"        );",
									"        ",
									"        if (responseJson.success !== undefined) {",
									"            pm.expect(responseJson.success).to.be.true;",
									"        } else if (responseJson.message) {",
									"            console.log(\"Success message: \" + responseJson.message);",
									"        }",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Success response does not expose reset token directly\", function () {",
									"    if (responseCode === 200 || responseCode === 201) {",
									"        pm.expect(responseJson).to.not.have.property('token');",
									"        pm.expect(responseJson).to.not.have.property('reset_token');",
									"        pm.expect(responseJson).to.not.have.property('resetToken');",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 7. ERROR MESSAGE STRUCTURE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"401 Unauthorized has proper error structure\", function () {",
									"    if (responseCode === 401) {",
									"        pm.expect(responseJson).to.have.property('message');",
									"        pm.expect(responseJson.message).to.be.a('string');",
									"        pm.expect(responseJson.message.toLowerCase()).to.include('unauthorized');",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"404 Not Found has proper error structure\", function () {",
									"    if (responseCode === 404) {",
									"        pm.expect(responseJson).to.have.property('message');",
									"        pm.expect(responseJson.message).to.be.a('string');",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"422 Validation Error has proper error structure\", function () {",
									"    if (responseCode === 422) {",
									"        pm.expect(responseJson).to.have.property('message');",
									"        // May also have 'errors' array for field-specific validation",
									"        if (responseJson.errors) {",
									"            pm.expect(responseJson.errors).to.be.an('array');",
									"        }",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"Error messages are user-friendly\", function () {",
									"    if (responseCode >= 400 && responseJson.message) {",
									"        pm.expect(responseJson.message.length).to.be.greaterThan(0);",
									"        pm.expect(responseJson.message.length).to.be.lessThan(500);",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 8. SECURITY CHECKS",
									"// ============================================",
									"",
									"pm.test(\"Response does not expose sensitive password data\", function () {",
									"    const responseText = JSON.stringify(responseJson).toLowerCase();",
									"    pm.expect(responseText).to.not.include('password');",
									"    pm.expect(responseText).to.not.include('pwd');",
									"    pm.expect(responseText).to.not.include('secret');",
									"});",
									"",
									"pm.test(\"Response does not expose internal tokens\", function () {",
									"    pm.expect(responseJson).to.not.have.property('token');",
									"    pm.expect(responseJson).to.not.have.property('access_token');",
									"    pm.expect(responseJson).to.not.have.property('jwt');",
									"    pm.expect(responseJson).to.not.have.property('api_key');",
									"});",
									"",
									"pm.test(\"Response does not expose database IDs or internal references\", function () {",
									"    pm.expect(responseJson).to.not.have.property('_id');",
									"    pm.expect(responseJson).to.not.have.property('user_id');",
									"    pm.expect(responseJson).to.not.have.property('internal_id');",
									"});",
									"",
									"pm.test(\"Response does not expose stack traces or debug info\", function () {",
									"    const responseText = JSON.stringify(responseJson).toLowerCase();",
									"    pm.expect(responseText).to.not.include('stack');",
									"    pm.expect(responseText).to.not.include('trace');",
									"    pm.expect(responseText).to.not.include('debug');",
									"    pm.expect(responseText).to.not.include('exception');",
									"});",
									"",
									"pm.test(\"No server information leaked in headers\", function () {",
									"    const serverHeader = pm.response.headers.get(\"Server\");",
									"    const xPoweredBy = pm.response.headers.get(\"X-Powered-By\");",
									"    ",
									"    // These headers should ideally not expose detailed version info",
									"    if (serverHeader) {",
									"        console.log(\"INFO: Server header present - review for security: \" + serverHeader);",
									"    }",
									"    if (xPoweredBy) {",
									"        console.log(\"WARNING: X-Powered-By header present - consider removing: \" + xPoweredBy);",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 9. RATE LIMITING VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Rate limit headers are present (if applicable)\", function () {",
									"    const rateLimitHeaders = [",
									"        'X-RateLimit-Limit',",
									"        'X-RateLimit-Remaining',",
									"        'X-RateLimit-Reset',",
									"        'RateLimit-Limit',",
									"        'RateLimit-Remaining',",
									"        'Retry-After'",
									"    ];",
									"    ",
									"    const hasRateLimitHeader = rateLimitHeaders.some(header => ",
									"        pm.response.headers.has(header)",
									"    );",
									"    ",
									"    if (hasRateLimitHeader) {",
									"        console.log(\"INFO: Rate limiting headers detected\");",
									"        pm.expect(hasRateLimitHeader).to.be.true;",
									"    } else {",
									"        console.log(\"INFO: No rate limit headers found - endpoint may not have rate limiting\");",
									"        this.skip();",
									"    }",
									"});",
									"",
									"pm.test(\"429 Too Many Requests handled properly\", function () {",
									"    if (responseCode === 429) {",
									"        pm.expect(responseJson).to.have.property('message');",
									"        const retryAfter = pm.response.headers.get(\"Retry-After\");",
									"        if (retryAfter) {",
									"            console.log(\"Retry-After: \" + retryAfter + \" seconds\");",
									"        }",
									"    } else {",
									"        this.skip();",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 10. EDGE CASES VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Empty email handling - should return validation error\", function () {",
									"    const requestBody = pm.request.body ? pm.request.body.raw : null;",
									"    if (requestBody) {",
									"        const parsedBody = JSON.parse(requestBody);",
									"        if (parsedBody.email === '' || parsedBody.email === null) {",
									"            pm.expect(responseCode).to.be.oneOf([400, 422]);",
									"        }",
									"    }",
									"    // This test validates the expected behavior for empty emails",
									"    console.log(\"INFO: Empty email should return 400 or 422 status\");",
									"});",
									"",
									"pm.test(\"Malformed email handling validation\", function () {",
									"    const requestBody = pm.request.body ? pm.request.body.raw : null;",
									"    if (requestBody) {",
									"        const parsedBody = JSON.parse(requestBody);",
									"        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;",
									"        ",
									"        if (parsedBody.email && !emailRegex.test(parsedBody.email)) {",
									"            // Malformed email should return validation error",
									"            pm.expect(responseCode).to.be.oneOf([400, 422]);",
									"            console.log(\"INFO: Malformed email detected - validation error expected\");",
									"        }",
									"    }",
									"});",
									"",
									"pm.test(\"SQL injection attempt detection\", function () {",
									"    const requestBody = pm.request.body ? pm.request.body.raw : null;",
									"    if (requestBody) {",
									"        const parsedBody = JSON.parse(requestBody);",
									"        const sqlInjectionPatterns = [",
									"            /('|\"|;|--|\\bOR\\b|\\bAND\\b|\\bUNION\\b|\\bSELECT\\b|\\bDROP\\b|\\bINSERT\\b|\\bDELETE\\b)/i",
									"        ];",
									"        ",
									"        const hasSqlInjection = sqlInjectionPatterns.some(pattern => ",
									"            pattern.test(parsedBody.email || '')",
									"        );",
									"        ",
									"        if (hasSqlInjection) {",
									"            // Should not return 200/201 for SQL injection attempts",
									"            pm.expect(responseCode).to.not.be.oneOf([200, 201]);",
									"            console.log(\"SECURITY: SQL injection pattern detected in input\");",
									"        }",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 11. HTTP METHOD VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"HTTP method is appropriate for forgot password\", function () {",
									"    const method = pm.request.method;",
									"    ",
									"    // Forgot password typically should be POST, not GET",
									"    if (method === 'GET') {",
									"        console.log(\"WARNING: GET method with body is unusual for forgot password\");",
									"        console.log(\"RECOMMENDATION: Consider using POST method for this endpoint\");",
									"    }",
									"    ",
									"    // Log the current method for awareness",
									"    console.log(\"Current HTTP method: \" + method);",
									"});",
									"",
									"pm.test(\"Request method documented\", function () {",
									"    const method = pm.request.method;",
									"    pm.expect(['GET', 'POST', 'PUT', 'PATCH']).to.include(method);",
									"    ",
									"    if (method === 'GET') {",
									"        console.log(\"NOTE: GET requests with body may not be supported by all servers\");",
									"        console.log(\"Some servers/proxies may strip the body from GET requests\");",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 12. RESPONSE CONSISTENCY - USER ENUMERATION PREVENTION",
									"// ============================================",
									"",
									"pm.test(\"Error messages do not reveal user existence (security)\", function () {",
									"    if (responseCode >= 400) {",
									"        const message = (responseJson.message || '').toLowerCase();",
									"        ",
									"        // Messages should NOT explicitly say \"user not found\" or \"user exists\"",
									"        // to prevent user enumeration attacks",
									"        const revealingPhrases = [",
									"            'user not found',",
									"            'user does not exist',",
									"            'no user with this email',",
									"            'email not registered',",
									"            'account not found'",
									"        ];",
									"        ",
									"        const revealsUserExistence = revealingPhrases.some(phrase => ",
									"            message.includes(phrase)",
									"        );",
									"        ",
									"        if (revealsUserExistence) {",
									"            console.log(\"SECURITY WARNING: Response may reveal user existence\");",
									"            console.log(\"RECOMMENDATION: Use generic message like 'If this email exists, a reset link will be sent'\");",
									"        }",
									"    }",
									"});",
									"",
									"pm.test(\"Response is consistent regardless of user existence\", function () {",
									"    // For security, forgot password should return same response",
									"    // whether user exists or not (to prevent enumeration)",
									"    if (responseCode === 200 || responseCode === 201) {",
									"        console.log(\"INFO: Success response - verify same response for non-existent users\");",
									"    }",
									"    ",
									"    // This is a documentation test - actual verification requires multiple requests",
									"    console.log(\"SECURITY NOTE: Verify that response is identical for existing and non-existing users\");",
									"});",
									"",
									"// ============================================",
									"// SUMMARY LOG",
									"// ============================================",
									"",
									"console.log(\"========================================\");",
									"console.log(\"FORGOT PASSWORD TEST SUMMARY\");",
									"console.log(\"========================================\");",
									"console.log(\"Response Status: \" + responseCode);",
									"console.log(\"Response Time: \" + pm.response.responseTime + \"ms\");",
									"console.log(\"Response Body: \" + JSON.stringify(responseJson));",
									"console.log(\"HTTP Method: \" + pm.request.method);",
									"console.log(\"========================================\");"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"tobi@gmail.example\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://api.practicesoftwaretesting.com/users/forgot-password",
							"protocol": "https",
							"host": [
								"api",
								"practicesoftwaretesting",
								"com"
							],
							"path": [
								"users",
								"forgot-password"
							]
						}
					},
					"response": []
				},
				{
					"name": "Change password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ============================================",
									"// Change Password API - Comprehensive Test Suite",
									"// POST /users/change-password",
									"// ============================================",
									"",
									"const response = pm.response;",
									"const responseBody = response.json();",
									"const statusCode = response.code;",
									"",
									"// ============================================",
									"// 1. STATUS CODE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Status code is valid (200, 204, 401, 403, or 422)\", function () {",
									"    pm.expect(statusCode).to.be.oneOf([200, 204, 401, 403, 422]);",
									"});",
									"",
									"pm.test(\"Status code 200/204 indicates successful password change\", function () {",
									"    if (statusCode === 200 || statusCode === 204) {",
									"        pm.expect(statusCode).to.be.oneOf([200, 204]);",
									"        console.log(\" Password changed successfully\");",
									"    }",
									"});",
									"",
									"pm.test(\"Status code 401 indicates unauthorized/invalid credentials\", function () {",
									"    if (statusCode === 401) {",
									"        pm.expect(responseBody).to.have.property(\"message\");",
									"        console.log(\" Unauthorized - Check authentication token or current password\");",
									"    }",
									"});",
									"",
									"pm.test(\"Status code 403 indicates forbidden access\", function () {",
									"    if (statusCode === 403) {",
									"        pm.expect(statusCode).to.eql(403);",
									"        console.log(\" Forbidden - User does not have permission\");",
									"    }",
									"});",
									"",
									"pm.test(\"Status code 422 indicates validation errors\", function () {",
									"    if (statusCode === 422) {",
									"        pm.expect(statusCode).to.eql(422);",
									"        console.log(\" Validation error - Check request body\");",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 2. RESPONSE BODY STRUCTURE VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Response body is valid JSON\", function () {",
									"    pm.response.to.be.json;",
									"});",
									"",
									"pm.test(\"Response contains appropriate message structure\", function () {",
									"    if (statusCode === 200) {",
									"        // Success response should have a message or success indicator",
									"        const hasMessage = responseBody.hasOwnProperty(\"message\") || ",
									"                          responseBody.hasOwnProperty(\"success\") ||",
									"                          responseBody.hasOwnProperty(\"status\");",
									"        pm.expect(hasMessage).to.be.true;",
									"    } else if (statusCode === 401 || statusCode === 403 || statusCode === 422) {",
									"        // Error responses should have message or error details",
									"        const hasErrorInfo = responseBody.hasOwnProperty(\"message\") || ",
									"                            responseBody.hasOwnProperty(\"error\") ||",
									"                            responseBody.hasOwnProperty(\"errors\");",
									"        pm.expect(hasErrorInfo).to.be.true;",
									"    }",
									"});",
									"",
									"pm.test(\"Error response has descriptive message\", function () {",
									"    if (statusCode >= 400) {",
									"        if (responseBody.message) {",
									"            pm.expect(responseBody.message).to.be.a(\"string\");",
									"            pm.expect(responseBody.message.length).to.be.greaterThan(0);",
									"        }",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 3. REQUIRED FIELD VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Request body contains required fields\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    ",
									"    pm.expect(requestBody).to.have.property(\"current_password\");",
									"    pm.expect(requestBody).to.have.property(\"new_password\");",
									"    pm.expect(requestBody).to.have.property(\"new_password_confirmation\");",
									"});",
									"",
									"pm.test(\"Required fields are not empty strings\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    ",
									"    pm.expect(requestBody.current_password).to.be.a(\"string\").and.not.empty;",
									"    pm.expect(requestBody.new_password).to.be.a(\"string\").and.not.empty;",
									"    pm.expect(requestBody.new_password_confirmation).to.be.a(\"string\").and.not.empty;",
									"});",
									"",
									"// ============================================",
									"// 4. PASSWORD CONFIRMATION MATCHING",
									"// ============================================",
									"",
									"pm.test(\"New password matches confirmation password\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password).to.eql(requestBody.new_password_confirmation);",
									"});",
									"",
									"// ============================================",
									"// 5. PASSWORD STRENGTH VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"New password meets minimum length requirement (8+ characters)\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password.length).to.be.at.least(8);",
									"});",
									"",
									"pm.test(\"New password contains uppercase letter\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password).to.match(/[A-Z]/);",
									"});",
									"",
									"pm.test(\"New password contains lowercase letter\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password).to.match(/[a-z]/);",
									"});",
									"",
									"pm.test(\"New password contains number\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password).to.match(/[0-9]/);",
									"});",
									"",
									"pm.test(\"New password contains special character\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password).to.match(/[!@#$%^&*(),.?\":{}|<>]/);",
									"});",
									"",
									"pm.test(\"Password is not too long (max 128 characters)\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password.length).to.be.at.most(128);",
									"});",
									"",
									"// ============================================",
									"// 6. CURRENT PASSWORD VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Current password is provided and not empty\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.current_password).to.be.a(\"string\");",
									"    pm.expect(requestBody.current_password.length).to.be.greaterThan(0);",
									"});",
									"",
									"pm.test(\"401 response indicates invalid current password or missing auth\", function () {",
									"    if (statusCode === 401) {",
									"        pm.expect(responseBody.message).to.be.a(\"string\");",
									"        // Common unauthorized messages",
									"        const validMessages = [\"Unauthorized\", \"Invalid credentials\", \"Invalid current password\", \"Authentication required\"];",
									"        const messageIsValid = validMessages.some(msg => ",
									"            responseBody.message.toLowerCase().includes(msg.toLowerCase())",
									"        );",
									"        pm.expect(messageIsValid || responseBody.message.length > 0).to.be.true;",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 7. PASSWORD CHANGE RULES",
									"// ============================================",
									"",
									"pm.test(\"New password is different from current password\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    pm.expect(requestBody.new_password).to.not.eql(requestBody.current_password);",
									"});",
									"",
									"// ============================================",
									"// 8. RESPONSE TIME / PERFORMANCE CHECK",
									"// ============================================",
									"",
									"pm.test(\"Response time is acceptable (under 5000ms)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(5000);",
									"});",
									"",
									"pm.test(\"Response time is optimal (under 2000ms)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});",
									"",
									"// ============================================",
									"// 9. CONTENT-TYPE HEADER VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Content-Type header is present\", function () {",
									"    pm.response.to.have.header(\"Content-Type\");",
									"});",
									"",
									"pm.test(\"Content-Type is application/json\", function () {",
									"    const contentType = pm.response.headers.get(\"Content-Type\");",
									"    pm.expect(contentType).to.include(\"application/json\");",
									"});",
									"",
									"// ============================================",
									"// 10. AUTHENTICATION VALIDATION",
									"// ============================================",
									"",
									"pm.test(\"Request includes Authorization header for authenticated endpoints\", function () {",
									"    const authHeader = pm.request.headers.get(\"Authorization\");",
									"    if (statusCode === 401 && !authHeader) {",
									"        console.log(\" Missing Authorization header - This endpoint requires authentication\");",
									"    }",
									"    // This test documents the requirement; actual auth check depends on API design",
									"    pm.expect(true).to.be.true; // Placeholder - adjust based on actual auth requirements",
									"});",
									"",
									"pm.test(\"401 response when authentication is missing or invalid\", function () {",
									"    if (statusCode === 401) {",
									"        pm.expect(responseBody).to.have.property(\"message\");",
									"        console.log(\"Authentication validation working correctly\");",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 11. SECURITY CHECKS",
									"// ============================================",
									"",
									"pm.test(\"Passwords are NOT returned in response body\", function () {",
									"    const responseString = JSON.stringify(responseBody).toLowerCase();",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    ",
									"    // Ensure passwords are not echoed back",
									"    pm.expect(responseString).to.not.include(requestBody.current_password.toLowerCase());",
									"    pm.expect(responseString).to.not.include(requestBody.new_password.toLowerCase());",
									"});",
									"",
									"pm.test(\"Response does not contain sensitive data fields\", function () {",
									"    const sensitiveFields = [\"password\", \"secret\", \"token\", \"api_key\", \"credit_card\", \"ssn\"];",
									"    ",
									"    sensitiveFields.forEach(field => {",
									"        pm.expect(responseBody).to.not.have.property(field);",
									"    });",
									"});",
									"",
									"pm.test(\"No password hash exposed in response\", function () {",
									"    const responseString = JSON.stringify(responseBody);",
									"    // Check for common hash patterns (MD5, SHA, bcrypt)",
									"    const hashPatterns = [",
									"        /\\$2[ayb]\\$.{56}/, // bcrypt",
									"        /^[a-f0-9]{32}$/i, // MD5",
									"        /^[a-f0-9]{64}$/i  // SHA-256",
									"    ];",
									"    ",
									"    hashPatterns.forEach(pattern => {",
									"        pm.expect(responseString).to.not.match(pattern);",
									"    });",
									"});",
									"",
									"// ============================================",
									"// 12. ERROR MESSAGE STRUCTURE",
									"// ============================================",
									"",
									"pm.test(\"Error response has proper structure for 401 Unauthorized\", function () {",
									"    if (statusCode === 401) {",
									"        pm.expect(responseBody).to.be.an(\"object\");",
									"        pm.expect(responseBody).to.have.property(\"message\");",
									"        pm.expect(responseBody.message).to.be.a(\"string\");",
									"    }",
									"});",
									"",
									"pm.test(\"Error response has proper structure for 422 Validation Error\", function () {",
									"    if (statusCode === 422) {",
									"        pm.expect(responseBody).to.be.an(\"object\");",
									"        // Validation errors typically have errors array or message",
									"        const hasValidationInfo = responseBody.hasOwnProperty(\"errors\") || ",
									"                                  responseBody.hasOwnProperty(\"message\");",
									"        pm.expect(hasValidationInfo).to.be.true;",
									"    }",
									"});",
									"",
									"pm.test(\"Validation errors provide field-specific feedback\", function () {",
									"    if (statusCode === 422 && responseBody.errors) {",
									"        pm.expect(responseBody.errors).to.be.an(\"object\");",
									"        // Check if errors reference specific fields",
									"        const possibleFields = [\"current_password\", \"new_password\", \"new_password_confirmation\"];",
									"        const errorKeys = Object.keys(responseBody.errors);",
									"        const hasFieldErrors = errorKeys.some(key => possibleFields.includes(key));",
									"        if (errorKeys.length > 0) {",
									"            console.log(\"Validation errors for fields:\", errorKeys);",
									"        }",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 13. EDGE CASES",
									"// ============================================",
									"",
									"pm.test(\"Edge case: Password fields are strings (not null/undefined)\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    ",
									"    pm.expect(requestBody.current_password).to.not.be.null;",
									"    pm.expect(requestBody.current_password).to.not.be.undefined;",
									"    pm.expect(requestBody.new_password).to.not.be.null;",
									"    pm.expect(requestBody.new_password).to.not.be.undefined;",
									"    pm.expect(requestBody.new_password_confirmation).to.not.be.null;",
									"    pm.expect(requestBody.new_password_confirmation).to.not.be.undefined;",
									"});",
									"",
									"pm.test(\"Edge case: Passwords do not contain only whitespace\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    ",
									"    pm.expect(requestBody.current_password.trim().length).to.be.greaterThan(0);",
									"    pm.expect(requestBody.new_password.trim().length).to.be.greaterThan(0);",
									"    pm.expect(requestBody.new_password_confirmation.trim().length).to.be.greaterThan(0);",
									"});",
									"",
									"pm.test(\"Edge case: Password handles special characters correctly\", function () {",
									"    const requestBody = JSON.parse(pm.request.body.raw);",
									"    const specialChars = /[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]/;",
									"    ",
									"    // If password contains special chars, request should still be processed",
									"    if (specialChars.test(requestBody.new_password)) {",
									"        pm.expect(statusCode).to.be.oneOf([200, 204, 401, 403, 422]);",
									"        console.log(\" Special characters in password handled correctly\");",
									"    }",
									"});",
									"",
									"// ============================================",
									"// 14. SUCCESS CONFIRMATION",
									"// ============================================",
									"",
									"pm.test(\"Success response (200) contains confirmation message\", function () {",
									"    if (statusCode === 200) {",
									"        const hasSuccessIndicator = responseBody.message || ",
									"                                    responseBody.success || ",
									"                                    responseBody.status === \"success\";",
									"        pm.expect(hasSuccessIndicator).to.be.ok;",
									"        console.log(\" Password change confirmed successfully\");",
									"    }",
									"});",
									"",
									"pm.test(\"Success response (204) has no content as expected\", function () {",
									"    if (statusCode === 204) {",
									"        // 204 No Content should have empty body",
									"        pm.expect(pm.response.text()).to.be.oneOf([\"\", \"{}\"]);",
									"        console.log(\" Password changed successfully (No Content response)\");",
									"    }",
									"});",
									"",
									"// ============================================",
									"// SUMMARY LOG",
									"// ============================================",
									"",
									"console.log(\"========================================\");",
									"console.log(\"Change Password Test Summary\");",
									"console.log(\"========================================\");",
									"console.log(\"Status Code:\", statusCode);",
									"console.log(\"Response Time:\", pm.response.responseTime + \"ms\");",
									"console.log(\"Response Body:\", JSON.stringify(responseBody, null, 2));",
									"console.log(\"========================================\");"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"current_password\": \"SuperSecure@123\",\r\n  \"new_password\": \"Dane@tobi12\",\r\n  \"new_password_confirmation\": \"Dane@tobi12\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://api.practicesoftwaretesting.com/users/change-password",
							"protocol": "https",
							"host": [
								"api",
								"practicesoftwaretesting",
								"com"
							],
							"path": [
								"users",
								"change-password"
							]
						}
					},
					"response": []
				},
				{
					"name": "Log out",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "https://api.practicesoftwaretesting.com/users/logout",
							"protocol": "https",
							"host": [
								"api",
								"practicesoftwaretesting",
								"com"
							],
							"path": [
								"users",
								"logout"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "created_user_id",
			"value": ""
		},
		{
			"key": "access_token",
			"value": ""
		},
		{
			"key": "token_type",
			"value": ""
		},
		{
			"key": "token_expires_in",
			"value": ""
		},
		{
			"key": "token_expires_at",
			"value": ""
		}
	]
}